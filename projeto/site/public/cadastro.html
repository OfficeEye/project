<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="assets/svg/officeeye-icon.png" type="image/x-icon">
    <title>Cadastro | OfficeEye</title>
    <link rel="stylesheet" href="css/cadastro.css">
    <script src="https://kit.fontawesome.com/4d31589572.js" crossorigin="anonymous"></script>
</head>
<body>
    <div class="cadastro-background">
        <div class="cadastro-box">
            <div class="cadastro-form">
                <div class="cadastro-title">
                    <h1>Bem-Vindo!</h1>
                    <h3>Cadastre sua empresa e aproveite os benefícios.</h3>
                </div>

                <div class="cadastro-section" id="section1">
                    <div class="cadastro-field">
                        <label for="nome_fantasia">Nome Fantasia</label>
                        <input id="nomeFantasia_input" type="text" autofocus autocomplete="off">
                        
                    </div>
                    <div class="cadastro-field">
                        <label for="razao_social">Razão Social</label>
                        <input id="razaoSocial_input" type="text" >
                       
                    </div>
                    <div class="cadastro-field">
                        <label for="cnpj">CNPJ</label>
                        <input id="cnpj_input" type="text" >
                       
                    </div>
                    <div class="cadastro-button">
                        <button onclick="mudarSection('section2')">Próximo</button>
                    </div>
                </div>

                <div class="cadastro-section" id="section2" style="display: none;">
                    <div class="cadastro-field">
                        <label for="email">E-mail</label>
                        <input id="email_input" type="text" autofocus autocomplete="off">
                    </div>
                    <div class="cadastro-field" id="field_senha">
                        <label for="senha">Senha</label>
                        <input id="senha_input" type="password" id="input_senha">
                        <div class="icon-password" id="icon_password">
                            <i class="fa-solid fa-lock" onclick="verSenha()" id="cadastro_field_password_lock"></i>
                        </div>
                       
                    </div>
                    <div class="cadastro-field">
                        <label for="confirmar_senha">Confirmar senha</label>
                        <input id="confirmacao_senha_input" type="password" >
                        <div class="icon-password" id="icon_password">
                            <i class="fa-solid fa-lock" onclick="verSenha()" id="cadastro_field_password_confirm_lock"></i>
                        </div>
                       
                    </div>
                    <div class="cadastro-button">
                        <button onclick="mudarSection('section1')">Voltar</button>
                        <button onclick="cadastrar()">Cadastrar</button>
                    </div>
                </div>
                
            </div>
            <div class="cadastro-image">
               
                    <img src="assets/svg/blob-haikei-cadastro.svg" alt="" id="image-background">
                    <img src="assets/svg/Business mission-pana.svg" alt="">
                
                <div class="box-text">
                    <p>Já possui uma conta? <a href="login.html">Faça Login</a></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
<script>

    function cadastrar() {
        var nomeFantasiaVar = nomeFantasia_input.value;
        var razaoSocialVar = razaoSocial_input.value;
        var cnpjVar = cnpj_input.value;
        var emailVar = email_input.value;
        var senhaVar = senha_input.value;
        var confirmacaoSenhaVar = confirmacao_senha_input.value;

        // if (
        //     nomeFantasiaVar == "" ||
        //     razaoSocialVar == "" ||
        //     cnpjVar == "" ||
        //     emailVar == "" ||
        //     senhaVar == "" ||
        //     confirmacaoSenhaVar == ""
        // ) {
            
        // } else if (nomeFantasiaVar.trim() == "") {
            
        // } else if (emailVar.trim() == "" || emailVar.indexOf("@") == -1 || emailVar.indexOf(".") == -1) {
            
        // } else if (senhaVar.length < 6) {
            
        // } else if (confirmacaoSenhaVar != senhaVar) {
            
        // } else {
            // setInterval(sumirMensagem, 3000)


            // Enviando o valor da nova input
            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vá para o arquivo routes/usuario.js
                    nomeFantasiaServer: nomeFantasiaVar,
                    razaoSocialServer: razaoSocialVar,
                    cnpjServer: cnpjVar,
                    emailServer: emailVar,
                    senhaServer: senhaVar
                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    // if (resposta.ok) {
                        // cardErro.style.display = "block";

                        // mensagem_erro.innerHTML =
                        //     "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

                        setTimeout(() => {
                            window.location = "login.html";
                        }, "3000");

                        limparFormulario();

                    // } else {
                    //     throw "Houve um erro ao tentar realizar o cadastro!";
                    // }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);

                });

            return false;
        // }
    }

    function mudarSection(id) {
        var abas = document.getElementsByClassName('cadastro-section');

        for (var i = 0; i < abas.length; i++) {
            abas[i].style.display = 'none';
        }

        document.getElementById(id).style.display = 'flex';
    }


</script>