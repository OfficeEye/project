<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <div class="cadastro-section" id="section2" style="display: none;">
        <div class="cadastro-field">
            <label for="nome">Nome</label>
            <input id="nomeUsuario_input" type="text" autofocus autocomplete="off">
        </div>
        <div class="cadastro-field">
            <label for="email">E-mail</label>
            <input id="email_input" type="text" autofocus autocomplete="off">
        </div>
        <div class="cadastro-field">
            <label for="tipoUsuario">Tipo</label>
            <select name="tipoUsuario" id="tipoUsuario_select">
                <option disabled selected>Tipo</option>
                <option value="Gerente">Gerente</option>
                <option value="Tecnico">Tecnico</option>
            </select>
        </div>
        <div>
            <label for="cpfUsuario">CPF</label>
            <input id="cpfUsuario_input" type="text" autofocus autocomplete="off">
        </div>
        <div class="cadastro-field" id="field_senha">
            <label for="senha">Senha</label>
            <input id="senha_input" type="password" id="input_senha">
            <div class="icon-password" id="icon_password">
                <i class="fa-solid fa-lock" onclick="verSenha()" id="cadastro_field_password_lock"></i>
            </div>
           
        </div>
        <div class="cadastro-field">
            <label for="confirmar_senha">Confirmar senha</label>
            <input id="confirmacao_senha_input" type="password" >
            <div class="icon-password" id="icon_password">
                <i class="fa-solid fa-lock" onclick="verSenha()" id="cadastro_field_password_confirm_lock"></i>
            </div>
           
        </div>
        <div class="cadastro-button">
            <button onclick="mudarSection('section1')">Voltar</button>
            <button onclick="cadastrarUsuario()">Cadastrar</button>
        </div>
    </div>

</body>
</html>

<script>

    function cadastrarUsuario() {
        var nomeUsuarioVar = nomeUsuario_input.value;
        var emailVar = email_Usuario_input.value;
        var tipoUsuarioVar = tipoUsuario_select.value;
        var cpfUsuarioVar = cpfUsuario_input.value;
        var senhaVar = senha_input.value;
        var confirmacaoSenhaVar = confirmacao_senha_input.value;

        // if (
        //     nomeFantasiaVar == "" ||
        //     razaoSocialVar == "" ||
        //     cnpjVar == "" ||
        //     emailVar == "" ||
        //     senhaVar == "" ||
        //     confirmacaoSenhaVar == ""
        // ) {
            
        // } else if (nomeFantasiaVar.trim() == "") {
            
        // } else if (emailVar.trim() == "" || emailVar.indexOf("@") == -1 || emailVar.indexOf(".") == -1) {
            
        // } else if (senhaVar.length < 6) {
            
        // } else if (confirmacaoSenhaVar != senhaVar) {
            
        // } else {
            // setInterval(sumirMensagem, 3000)


            // Enviando o valor da nova input
            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    // crie um atributo que recebe o valor recuperado aqui
                    // Agora vÃ¡ para o arquivo routes/usuario.js
                    nomeUsuarioServer: nomeUsuarioVar,
                    emailServer: emailVar,
                    cnpjServer: tipoUsuarioVar,
                    emailServer: cpfUsuarioVar,
                    senhaServer: senhaVar
                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    // if (resposta.ok) {
                        // cardErro.style.display = "block";

                        // mensagem_erro.innerHTML =
                        //     "Cadastro realizado com sucesso! Redirecionando para tela de Login...";

                        setTimeout(() => {
                            window.location = "login.html";
                        }, "3000");

                        limparFormulario();

                    // } else {
                    //     throw "Houve um erro ao tentar realizar o cadastro!";
                    // }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);

                });

            return false;
        // }
    }

</script>